---
title: "210126-TIL"

categories:
  - til
tags:
  - til
---

# TIL

- 페스티벌 디테일 페이지

# Thinking

- 타입스크립트를 쓰게 되면서 예상치 못한 에러가 너무나 많이 난다. 자바스크립트랑 리액트에서는 너무나 당연시하게 돌아가던 코드들에서 에러가 발생하여 해결하느라 너무나 많은 시간이 소비된다. 주로 해당 속성을 찾을 수 없거나 설정한 타입하고 매치되지 않는다는 오류였다.

- 특히, 상황에 따라서 2가지 타입을 갖는 변수나, 초기값 설정이나 error 발생 시 null이나 undefined 타입을 설정해줘야 하는 상황에서 자주 발생하였다. 이렇게 타입을 설정하게 되면 해당 변수를 쓰는 모든 곳에서 2가지 타입 혹은 null, undefined에 대한 상황까지 가정을 해줘야 한다. (즉, data.id 등을 바로 쓸 수 없다. 해당 값은 data 타입일 때만 사용 가능하지, null이나 undfeined, 혹은 id 속성이 없는 특정 타입에서는 오류가 나기 때문이다.) 이러한 모든 상황을 생각하고 분기처리를 해준다던지 타입 혹은 변수의 사용을 제한한다던지 하는 경우가 생겨서 매우 힘들었다.

- 전자와 같은 상황은 그나마 끼워맞추기 식으로라도 해결이 가능한데, window나 DOM element, 기타 모듈이나 라이브러리를 사용할 때 정말 애매하다. 타입스크립트에서 어느 정도 기본적으로 지원은 하지만 지원되지 않은 경우에는 모든 타입과 인터페이스들을 지정해줘야 한다. 이게 단순하게 any로 설정하거나 특정 라이브러리 타입 선언이나 속성, 아웃 값 정도면 어찌어찌 인터페이스를 만들어서 활용하겠는데, window나 DOM element에서 타입스크립트에서 지원하지 않는 속성이나 메서드 등을 활용하려면 정말 복잡하다. 해당 속성이나 메서드에 대해서 다 파헤쳐야하고, 특히, 외부 api 등으로 새로운 속성이나 메서드가 추가되거나 하면 그 상황까지 생각하고 만들어줘야한다니. 여간 골치 아픈 것이 아니다. (any로 설정하여도 여간 오류가 많이 나버린다)

- createReducer로 immutable하게 state를 다룰 수 있다고 하는데, 타입스크립트에서는 리턴값 타입에 걸려서 제대로 활용을 하지 못하고, 결국 객체 깊은복사로 해결하였다. (뭔가 redux 개발자 도구 상으로 state 값은 제대로 바뀌는데 react에서 state 변화를 제대로 감지 못하고 랜더되지 않는다. redux state는 업데이트 되었을지 언정, react에서 참조하고 있는 state는 예전 값이기에 재랜더 되지 않는 것 같다. 결국 리듀서에서 깊은복사로 state를 리턴해줌으로써 해결하긴 하였다)

- 오늘은 offset과 limit 쿼리까지 설정하여 자료를 순차적으로 받는 비즈니스 로직을 구현하였다. 문제는 첫 요청의 경우에는 (카테고리 분류 등) 기존 데이터를 요청받은 데이터로 싹다 초기화를 해주어야하고, 다음 요청부터는 해당 데이터에 추가적으로 push주는 형태로 가야한다는 것이다. 일반적으로 pagenation으로 구현하거나 카테고리 로직이랑 완전히 나눠진걸로 알고 있는데, 개발을 하다가 추가된 기능이라 설계단계에서 잡지 못하였다.

- 그러기 때문에 첫번째 요청임을 알려주는 분기처리를 하거나 추가적으로 요청하는 비즈니스 로직을 따로 만들거나 해야한다. 백에서 구분되는 데이터를 받는 것은 영 아닌 것 같고, saga에서 해당 로직을 별도로 만들려니 복잡해지고, 결국 비즈니스 로직을 별도로 하나 더 만들었다.
